<?xml version="1.0"?>
<!--
/*
 * Copyright 2010 Outerthought bvba
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
-->
<project xmlns="http://maven.apache.org/POM/4.0.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd">

  <modelVersion>4.0.0</modelVersion>
  <groupId>org.lilyproject</groupId>
  <artifactId>lily-dist</artifactId>
  <version>2.0</version>

  <parent>
    <groupId>org.lilyproject</groupId>
    <artifactId>lily</artifactId>
    <version>2.0</version>
    <relativePath>../</relativePath>
  </parent>

  <name>Lily: binary distribution</name>

  <dependencies>
   <!-- fixme do we still need to add commons-configuration? -->
    <!-- This dependency is here because otherwise Maven doesn't include its recursive dependencies. (they are excluded in lily-hbase-client but not in another project (they come in via a dependency of hbase:tests), and in the context here Maven
      decides to take the commons-configuration from lily-hbase-client. Quite annoying.)
    -->
    <dependency>
      <groupId>commons-configuration</groupId>
      <artifactId>commons-configuration</artifactId>
    </dependency>
  </dependencies>

  <build>
    <resources>
      <!--
      <resource>
        <directory>src/main/resources</directory>
        <filtering>false</filtering>
      </resource>
      -->
      <resource>
        <directory>src/main/resources-filtered</directory>
        <filtering>true</filtering>
      </resource>
    </resources>

    <plugins>      
      <plugin>
        <artifactId>maven-assembly-plugin</artifactId>
        <configuration>
          <finalName>lily-${project.version}</finalName>
          <appendAssemblyId>false</appendAssemblyId>
          <tarLongFileMode>gnu</tarLongFileMode>
          <descriptors>
            <descriptor>dist-assembly.xml</descriptor>
          </descriptors>
        </configuration>
      </plugin>

      <plugin>
        <groupId>org.lilyproject</groupId>
        <artifactId>lily-kauri-plugin</artifactId>
        <version>2.0</version>
        <configuration>
          <confDirectory>${basedir}/../cr/process/server/conf</confDirectory>
          <artifacts>
            <artifact>org.lilyproject:lily-import:${project.version}</artifact>
            <artifact>org.lilyproject:lily-mbox-import:${project.version}</artifact>
            <artifact>org.lilyproject:lily-tester:${project.version}</artifact>
            <artifact>org.lilyproject:lily-indexer-admin-cli:${project.version}</artifact>
            <artifact>org.lilyproject:lily-rowlog-admin-cli:${project.version}</artifact>
            <artifact>org.lilyproject:lily-server-test-fw:${project.version}</artifact>
            <artifact>org.lilyproject:lily-standalone-launcher:${project.version}</artifact>
            <artifact>org.lilyproject:lily-print-host:${project.version}</artifact>
            <artifact>org.lilyproject:lily-upgrade:${project.version}</artifact>
            <artifact>org.lilyproject:lily-linkindex-cli:${project.version}</artifact>
            <artifact>org.lilyproject:lily-scan-records:${project.version}</artifact>
            <artifact>org.lilyproject:lily-rowlog-visualizer:${project.version}</artifact>
            <artifact>org.lilyproject:lily-record-row-visualizer:${project.version}</artifact>
            <artifact>org.lilyproject:lily-archetype-basic:${project.version}</artifact>
            <artifact>org.lilyproject:lily-archetype-lily-server-plugin:${project.version}</artifact>
            <artifact>org.lilyproject:lily-kauri-plugin:${project.version}</artifact>
          </artifacts>
        </configuration>
      </plugin>
    </plugins>
  </build>

</project>
